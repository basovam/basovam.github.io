<!doctype html>
<html>
	<head>
		<title>Circle</title>
		<meta charset='utf-8' />
		<script>

	</script>
	</head>
	<body>
		<center><canvas height='601' width='301' id='Circle'>Обновите браузер</canvas>
		</center>
		<script>
			var canv = document.getElementById("Circle");
			var elem = canv
			a = 0;
			offsetX = 0;
			offsetY = 0;
			while (elem)
			{
				offsetX += elem.offsetLeft;
				offsetY += elem.offsetTop;
				elem = elem.offsetParent;
			}
			var ctx = canv.getContext('2d');
			ctx.fillStyle="#ffffff";
			ctx.fillRect(0,0,301,601);
			ctx.fillStyle="#000000";
			/*ctx.beginPath();
			ctx.moveTo(0.5, 0.5);
			ctx.lineTo(0.5, 600.5);
			ctx.lineTo(300.5, 600.5);
			ctx.lineTo(300.5, 0.5);
			ctx.lineTo(0.5, 0.5);
			ctx.closePath();
			ctx.stroke();*/
			
			ctx.beginPath();
            ctx.arc(150.5, 300.5, 15, Math.PI/4+a, 2*Math.PI/4+a,true);
            ctx.arc(150.5, 300.5, 135, 2*Math.PI/4+a, Math.PI/4+a,false);
            ctx.closePath();
			ctx.stroke();
			
			/*ctx.beginPath();
            ctx.arc(150.5, 300.5, 55, 3*Math.PI/4, 4*Math.PI/4,true);
            ctx.arc(150.5, 300.5, 95, 4*Math.PI/4, 3*Math.PI/4,false);
            ctx.closePath();
			ctx.stroke();
			
			ctx.beginPath();
            ctx.arc(150.5, 300.5, 95, 3*Math.PI/4, 4*Math.PI/4,true);
            ctx.arc(150.5, 300.5, 135, 4*Math.PI/4, 3*Math.PI/4,false);
            ctx.closePath();
			ctx.stroke();*/
			
			ongoingTouches = new Array();
			
			canv.addEventListener('touchstart', e => {
				var touches = e.changedTouches;
				for (var i = 0; i < touches.length; i++) {
					ongoingTouches.push({identifier: touches[i].identifier, pageX: touches[i].pageX, pageY: touches[i].pageY});
				}
			});
			
			canv.addEventListener("touchmove", e => {
				var elem = document.getElementById("Circle");
				var ctx = elem.getContext('2d');
				var touches = e.changedTouches;
				for (var i = 0; i < touches.length; i++) {
					var idx = 0;
					for (var j = 0; j < ongoingTouches.length; j++) {
						if (ongoingTouches[j].identifier == touches[i].identifier) idx = j;
					}
					if (idx >= 0) {
						var x = ongoingTouches[idx].pageX-offsetX;
						var y = ongoingTouches[idx].pageY-offsetY;
						var a1 = Math.acos((150.5-x)/Math.sqrt((150.5-x)*(150.5-x)+(300.5-y)*(300.5-y)));
						x = touches[i].pageX-offsetX;
						y = touches[i].pageY-offsetY;
						var a2 = Math.acos((150.5-x)/Math.sqrt((150.5-x)*(150.5-x)+(300.5-y)*(300.5-y)));
						a += a1 - a2;
						ctx.fillStyle="#ffffff";
						ctx.fillRect(0,0,301,601);
						ctx.fillStyle="#000000";
						ctx.beginPath();
						ctx.arc(150.5, 300.5, 15, Math.PI/4+a, 2*Math.PI/4+a,true);
						ctx.arc(150.5, 300.5, 135, 2*Math.PI/4+a, Math.PI/4+a,false);
						ctx.closePath();
						ctx.stroke();
						ongoingTouches.splice(idx, 1, {identifier: touches[i].identifier, pageX: touches[i].pageX, pageY: touches[i].pageY});
					}
				}
			});
		</script>
	</body>
</html>